name: 'Clair V4'
description: 'Scans container images for vulnerabilities'
author: 'Red Hat'
inputs:
  image-ref:
    description: 'A remote reference for the image to be scanned'
    required: false
    default: ''
  image-path:
    description: 'A path to the image .tar file (generated from the docker save command) to be scanned'
    required: false
    default: ''
  format:
    description: 'In which format to produce the results'
    required: false
    default: 'sarif'
  output:
    description: 'Where to put the results'
    required: false
    default: 'sarif'
runs:
  using: "docker"
  image: "Dockerfile"
  args:
    - '${{ inputs.output }}'
    - '--image-ref=${{ inputs.image-ref }}'
    - '--image-path=${{ inputs.image-path }}'
    - '--format=${{ inputs.format }}'
